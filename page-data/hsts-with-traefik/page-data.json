{"componentChunkName":"component---src-templates-post-js","path":"/hsts-with-traefik","result":{"data":{"markdownRemark":{"html":"<p>The settings to get an A+ rating on SSL Labs!</p>\n<!-- more -->\n<p>I didn't find any simple guide out there to do this so I thought I'd write it myself.</p>\n<h2 id=\"traefik-hsts-configuration\" style=\"position:relative;\"><a href=\"#traefik-hsts-configuration\" aria-label=\"traefik hsts configuration permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Traefik HSTS Configuration</h2>\n<p>The Traefik documentation talks about HSTS headers in <a href=\"https://docs.traefik.io/basics/#security-headers\">only one place</a> and it doesn't even provide an example for it. All Traefik security headers, including HSTS, can be found can be found at a separate GitHub repo: <a href=\"https://github.com/unrolled/secure#available-options\">unrolled/secure</a>.</p>\n<p>Add the following Docker labels to your container or your <code class=\"language-text\">traefik.toml</code> file's frontend:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-yaml line-numbers\"><code class=\"language-yaml\"><span class=\"token key atrule\">traefik.frontend.headers.STSSeconds</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"31536000\"</span>\n<span class=\"token key atrule\">traefik.frontend.headers.STSIncludeSubdomains</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"true\"</span>\n<span class=\"token key atrule\">traefik.frontend.headers.STSPreload</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"true\"</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>While you're there, only accept the latest ciphers. This can be configured on the HTTPS entrypoint:</p>\n<div class=\"gatsby-highlight\" data-language=\"toml\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-toml line-numbers\"><code class=\"language-toml\"><span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints.http</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key property\">address</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\":80\"</span>\n    <span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints.http.redirect</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key property\">entryPoint</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"https\"</span>\n  <span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints.https</span><span class=\"token punctuation\">]</span>\n    <span class=\"token key property\">address</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\":443\"</span>\n    <span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints.https.tls</span><span class=\"token punctuation\">]</span>\n      <span class=\"token key property\">minVersion</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"VersionTLS12\"</span>\n      <span class=\"token key property\">cipherSuites</span> <span class=\"token punctuation\">=</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token string\">\"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token string\">\"TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305\"</span>\n      <span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/41f69baa47f82459cb5450d339c470fa/20801/ssllabs-result.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAECAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAAB2kRktGL/AP/EABkQAAMBAQEAAAAAAAAAAAAAAAABAhEhMf/aAAgBAQABBQLEinEmIe70nz//xAAWEQADAAAAAAAAAAAAAAAAAAABEBH/2gAIAQMBAT8BpX//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAZEAACAwEAAAAAAAAAAAAAAAAAMQEQIRH/2gAIAQEABj8C5hooGOv/xAAcEAACAgIDAAAAAAAAAAAAAAAAARExIZFhgcH/2gAIAQEAAT8hlKGVYGkItCi8B6k0c0fRKx//2gAMAwEAAgADAAAAECAv/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQBB/9oACAEDAQE/EHKFv//EABcRAQEBAQAAAAAAAAAAAAAAAAEAIUH/2gAIAQIBAT8QV5G3/8QAHRABAAMAAQUAAAAAAAAAAAAAAQARITFBUXGh4f/aAAgBAQABPxC3CW0pBJ7V9cTbJ0zLCgDnZ7mm/JfcS1FvkKn/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ssllabs result\"\n        title=\"ssllabs result\"\n        src=\"/static/41f69baa47f82459cb5450d339c470fa/20801/ssllabs-result.jpg\"\n        srcset=\"/static/41f69baa47f82459cb5450d339c470fa/08b27/ssllabs-result.jpg 213w,\n/static/41f69baa47f82459cb5450d339c470fa/6f6b2/ssllabs-result.jpg 425w,\n/static/41f69baa47f82459cb5450d339c470fa/20801/ssllabs-result.jpg 720w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"what-is-hsts\" style=\"position:relative;\"><a href=\"#what-is-hsts\" aria-label=\"what is hsts permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What is HSTS</h2>\n<p><strong>HTTP Strict Transport Security (HSTS)</strong> tells browsers that your site should <em>ONLY</em> be accessed with <strong>HTTPS</strong> instead of <strong>HTTP</strong>. After the initial connection over <strong>HTTPS</strong>, your browser will never load the site using <strong>HTTP</strong> and will attempt to convert all connections using <strong>HTTP</strong> to <strong>HTTPS</strong> instead.</p>\n<h2 id=\"websites\" style=\"position:relative;\"><a href=\"#websites\" aria-label=\"websites permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Websites</h2>\n<p>Some other websites to check your HTTPS configuration as well as other web features:</p>\n<ul>\n<li><a href=\"https://www.ssllabs.com/ssltest/\">SSL Labs</a> is the de-facto place to test your site's SSL configuration</li>\n<li><a href=\"https://cipherli.st/\">Cipherli.st</a> provide settings for Apache, NGINX and Lightppd</li>\n<li><a href=\"https://ssldecoder.org\">SSL Decoder</a> provides similar tests as SSL Labs</li>\n<li><a href=\"https://observatory.mozilla.org/\">Observatory by Mozilla</a> is tester that can do HTTP, TLS, SSH</li>\n<li><a href=\"https://tls.imirhil.fr/\">CryptCheck</a> is a site that tests HTTPS, SMTP and XMPP</li>\n<li><a href=\"https://www.immuniweb.com/free/\">Immuni Web</a> provide free tests for website security, mobile app security, SSL and phishing.</li>\n<li><a href=\"https://securityheaders.com\">Security Headers</a> checks for headers in your site and gives it a rating</li>\n<li><a href=\"https://ssl-config.mozilla.org\">Mozilla provide all these settings already</a> but for some reason there's no easy guide out there, so I made one.</li>\n</ul>","timeToRead":2,"excerpt":"The settings to get an A+ rating on SSL Labs! I didn't find any simple guide out there to do this so I thought I'd write it myself. Traefikâ€¦","fileAbsolutePath":"/home/runner/work/calvin.me/calvin.me/master/posts/2019-08-06-hsts-with-traefik/index.md","frontmatter":{"title":"HSTS with Traefik","categories":["Web","Networking","Security"],"tags":["hsts","traefik"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","backgroundColor":"#080808","images":{"fallback":{"src":"/static/562e80fcadd3d690ad07f7b7f206f394/ccc8a/thumbnail.png","srcSet":"/static/562e80fcadd3d690ad07f7b7f206f394/ccc8a/thumbnail.png 150w,\n/static/562e80fcadd3d690ad07f7b7f206f394/67d4a/thumbnail.png 300w","sizes":"150px"},"sources":[{"srcSet":"/static/562e80fcadd3d690ad07f7b7f206f394/3554d/thumbnail.webp 150w,\n/static/562e80fcadd3d690ad07f7b7f206f394/c437f/thumbnail.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}}}}},"pageContext":{"filter":"/^.*\\/\\d{4}-\\d{2}-\\d{2}-hsts-with-traefik\\/.*$/"}},"staticQueryHashes":[]}