{"componentChunkName":"component---src-templates-post-js","path":"/cracking-passwords-on-macos","result":{"data":{"markdownRemark":{"html":"<p><a href=\"https://www.openwall.com/john/\">John The Ripper</a> is a free and open-source software for fast password cracking. Cracking DMG, RAR and other types of passwords is made easier using <a href=\"https://github.com/magnumripper/JohnTheRipper\">magnumripper's \"jumbo\" version of John The Ripper</a>.</p>\n<!-- more -->\n<h2 id=\"install-john\" style=\"position:relative;\"><a href=\"#install-john\" aria-label=\"install john permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Install John</h2>\n<p>Install John The Ripper using <code class=\"language-text\">brew</code></p>\n<div class=\"gatsby-highlight\" data-language=\"shell-session\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell-session line-numbers\"><code class=\"language-shell-session\"><span class=\"token command\"><span class=\"token shell-symbol important\">$</span> <span class=\"token bash language-bash\">brew <span class=\"token function\">install</span> john-jumbo</span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h2 id=\"find-john-the-ripper-utilities-folder\" style=\"position:relative;\"><a href=\"#find-john-the-ripper-utilities-folder\" aria-label=\"find john the ripper utilities folder permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Find John The Ripper Utilities Folder</h2>\n<p>John comes with extra utilities to help generate hashes. By default <code class=\"language-text\">brew</code> does not install/symlink john's extra utilities to the PATH folder <code class=\"language-text\">/usr/local/bin</code>. The path can be found in a variety of ways:</p>\n<ol>\n<li>Using <code class=\"language-text\">ls</code> and following the path will eventually return <code class=\"language-text\">/usr/local/Cellar/john-jumbo/1.9.0/share/john/</code> or similar:</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"shell-session\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell-session line-numbers\"><code class=\"language-shell-session\"><span class=\"token command\"><span class=\"token shell-symbol important\">$</span> <span class=\"token bash language-bash\"><span class=\"token function\">ls</span> -al /usr/local/bin/john</span></span>\n<span class=\"token output\">lrwxr-xr-x 1 admin admin 35 Mar 16 20:04 /usr/local/bin/john -> ../Cellar/john-jumbo/1.9.0/bin/john\n\n</span><span class=\"token command\"><span class=\"token shell-symbol important\">$</span> <span class=\"token bash language-bash\"><span class=\"token function\">ls</span> -al /usr/local/Cellar/john-jumbo/1.9.0/bin/john</span></span>\n<span class=\"token output\">lrwxr-xr-x 1 calvin staff 18 May 15  2019 /usr/local/Cellar/john-jumbo/1.9.0/bin/john -> ../share/john/john\n\n</span><span class=\"token command\"><span class=\"token shell-symbol important\">$</span> <span class=\"token bash language-bash\"><span class=\"token function\">ls</span> -1 /usr/local/Cellar/john-jumbo/1.9.0/share/john/ <span class=\"token operator\">|</span> <span class=\"token function\">head</span> -n <span class=\"token number\">5</span></span></span>\n<span class=\"token output\">1password2john.py\n7z2john.pl\nDPAPImk2john.py\nSIPdump\nadxcsouf2john.py</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ol start=\"2\">\n<li>If you have <code class=\"language-text\">readlink</code> installed, it's even easier:</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"shell-session\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell-session line-numbers\"><code class=\"language-shell-session\"><span class=\"token command\"><span class=\"token shell-symbol important\">$</span> <span class=\"token bash language-bash\"><span class=\"token function\">dirname</span> <span class=\"token variable\"><span class=\"token variable\">$(</span>readlink -f /usr/local/bin/john<span class=\"token variable\">)</span></span></span></span>\n<span class=\"token output\">/usr/local/Cellar/john-jumbo/1.9.0/share/john</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h2 id=\"generating-hashes\" style=\"position:relative;\"><a href=\"#generating-hashes\" aria-label=\"generating hashes permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Generating Hashes</h2>\n<p>When cracking files, John cracks the hash of the password rather than the file itself. To generate the hash files, we use the extra utilities from the folder in the last step.</p>\n<p>For DMG files, we'll pass the <code class=\"language-text\">encrypted-files.dmg</code> file to the <code class=\"language-text\">dmg2john</code> command and output the hash to a <code class=\"language-text\">.hash</code> file.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell-session\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell-session line-numbers\"><code class=\"language-shell-session\"><span class=\"token command\"><span class=\"token shell-symbol important\">$</span> <span class=\"token bash language-bash\">/usr/local/Cellar/john-jumbo/1.9.0/share/john/dmg2john encrypted-files.dmg <span class=\"token operator\">></span> encrypted-files.dmg.hash</span></span>\n<span class=\"token output\">encrypted-files.dmg (DMG v2) successfully parsed, iterations count 333333</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>The other tools available to generate hash files are:</p>\n<ul>\n<li>RAR: <code class=\"language-text\">rar2john_cmd</code></li>\n<li>PDF: <code class=\"language-text\">pdf2john.pl</code></li>\n<li>ZIP: <code class=\"language-text\">zip2john</code></li>\n<li>7Z: <code class=\"language-text\">7z2john.pl</code></li>\n</ul>\n<h2 id=\"crack-the-hash\" style=\"position:relative;\"><a href=\"#crack-the-hash\" aria-label=\"crack the hash permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Crack the Hash</h2>\n<p>The last step is to crack the hash. We use the <code class=\"language-text\">john</code> tool directly for this step.</p>\n<p>To ensure the GPU instead of the CPU is doing the cracking, specify a format with <code class=\"language-text\">-opencl</code> in its suffix. For example, <code class=\"language-text\">dmg</code> will be significantly slower than using <code class=\"language-text\">dmg-opencl</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell-session\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell-session line-numbers\"><code class=\"language-shell-session\"><span class=\"token command\"><span class=\"token shell-symbol important\">$</span> <span class=\"token bash language-bash\">john --format<span class=\"token operator\">=</span>dmg-opencl encrypted-files.dmg.hash</span></span>\n<span class=\"token output\">Device 3: AMD Radeon Pro 560X Compute Engine\nUsing default input encoding: UTF-8\nLoaded 1 password hash (dmg-opencl, Apple DMG [PBKDF2-SHA1 3DES/AES OpenCL])\nCost 1 (iteration count) is 333333 for all loaded hashes\nCost 2 (version) is 2 for all loaded hashes\nError creating binary cache file: No such file or directory\nPress 'q' or Ctrl-C to abort, almost any other key for status\nWarning: Only 13888 candidates left, minimum 16384 needed for performance.\nabc_123 (encrypted-files.dmg)\n1g 0:00:00:57 N/A 0.01747g/s 815.3p/s 815.3c/s 815.3C/s abc_000..abc_123\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>You can see the password above is <code class=\"language-text\">abc_123</code>. If it's not clear you can run <code class=\"language-text\">john --show encrypted-files.dmg.hash</code> to present it clearer.</p>\n<p>To make things even faster, if you have an idea of what the password is, you can pass a regular expression to john using the <code class=\"language-text\">--mask</code> flag.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell-session\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell-session line-numbers\"><code class=\"language-shell-session\"><span class=\"token command\"><span class=\"token shell-symbol important\">$</span> <span class=\"token bash language-bash\">john --format<span class=\"token operator\">=</span>dmg-opencl --mask<span class=\"token operator\">=</span><span class=\"token string\">\"abc_[0-9][0-9][0-9]\"</span> encrypted-files.dmg.hash</span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Another thing I like to do at the end is remove the password on the DMG file and keep it empty:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell-session\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-shell-session line-numbers\"><code class=\"language-shell-session\"><span class=\"token command\"><span class=\"token shell-symbol important\">$</span> <span class=\"token bash language-bash\"><span class=\"token builtin class-name\">printf</span> <span class=\"token string\">'%s<span class=\"token entity\" title=\"\\0\">\\0</span>'</span> abc_123 <span class=\"token string\">''</span> <span class=\"token operator\">|</span> hdiutil chpass encrypted-files.dmg -oldstdinpass -newstdinpass</span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>Now when you open it, click the OK button.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 556px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8893967d65c76c7eb5802788f7d36929/68b51/enter-password.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.460093896713616%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACZElEQVQoz53SXU/TYBQH8EPCEqIoNbABLbKNC13ZS19YX56uayl76dptbIBbQDBGrow3xmiM4cYbbzRGA5JgNDEhMfoN2K3fyBjuaOkxrUrgSuPFL//nPCfnXB2oVCrQaDTAcRywbRtarVYkrP9wXfeC8712ux1ls9mM5sFxXWBZNkkI2VMV+T1R1QNFUQ5kWf4nqqp+IIS8nJubi1erNYCtzU1IpVINQRBQUggKYhEVRUFN05BoWpSqqiIh5Iz2+z8kSRKGszRNS91uF+D123cwOTXVEUXBe/LogXfvTu+EaJpn27bXsG3PaTS8Wq0WZb1W81zX9VzXifqtZvNEL5VO87nc90QiUX62swNQuf8RRsamV1xTwG/7HVxrlwNJVnHRNFAuGVjQLOSIec4ictpi9C4QMxCNOvJK6XicumI+3e4DvNo/hPgkvaIUeWxZPGZz+UDX9WDJsgLdqgbWcj+oLveCynIvWGrfCqzWWmA43WCptRLU253Tsu0iJ5PjiWuU8Xh7C+DL50Ng6Okux/F+tiD6oij6HMf5+XzeF3je13XdNwzDL5fLvmmavuO4vl2v+YZl+7p715Mq65jnpR+J8THj+cM+wO7eHtA0vSqKAhaLC7iwcBHP8xGO41CWZVzfuI2bG30Uyx1kV99grreL87LtTVND5ou1EQBEBIqipHQ6/TWZTB6dMwilUqkzYc0wzIBmmEFyduYoxUyEBunk9U+XR6+y4S6Ix+NDADAKALMAkP0P8wAwAwCXJiYZiC4/XJrJZIYzmUzs79gYy/7KG5ls7Cabi93MsMMUNTZUyGfhJ9pnCBgLspuaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"enter password\"\n        title=\"enter password\"\n        src=\"/static/8893967d65c76c7eb5802788f7d36929/68b51/enter-password.png\"\n        srcset=\"/static/8893967d65c76c7eb5802788f7d36929/53f68/enter-password.png 213w,\n/static/8893967d65c76c7eb5802788f7d36929/df70d/enter-password.png 425w,\n/static/8893967d65c76c7eb5802788f7d36929/68b51/enter-password.png 556w\"\n        sizes=\"(max-width: 556px) 100vw, 556px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"script\" style=\"position:relative;\"><a href=\"#script\" aria-label=\"script permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Script</h2>\n<p>To put all the above together, I use this script to set aliases to crack DMG files</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/usr/bin/env bash</span>\n\n<span class=\"token function-name function\">dmg2john_cmd</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Generating hash file\"</span>\n  <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">dirname</span> <span class=\"token punctuation\">$(</span>readlink -f /usr/local/bin/john<span class=\"token punctuation\">)</span><span class=\"token variable\">)</span></span>/dmg2john\"</span> <span class=\"token string\">\"<span class=\"token variable\">$1</span>\"</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function-name function\">dmgcrack</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token assign-left variable\">dmg</span><span class=\"token operator\">=</span><span class=\"token string\">\"<span class=\"token variable\">$1</span>\"</span>\n  dmg2john_cmd <span class=\"token string\">\"<span class=\"token variable\">${dmg}</span>\"</span> <span class=\"token operator\">></span> <span class=\"token string\">\"<span class=\"token variable\">${dmg}</span>\"</span>.hash\n  john --format<span class=\"token operator\">=</span>dmg-opencl <span class=\"token string\">\"<span class=\"token variable\">${dmg}</span>\"</span>.hash\n  <span class=\"token assign-left variable\">password</span><span class=\"token operator\">=</span><span class=\"token variable\"><span class=\"token variable\">$(</span>john --show <span class=\"token string\">\"<span class=\"token variable\">${dmg}</span>\"</span>.hash <span class=\"token operator\">|</span> <span class=\"token function\">sed</span> <span class=\"token string\">'1q;d'</span> <span class=\"token operator\">|</span> <span class=\"token function\">cut</span> -d<span class=\"token string\">':'</span> -f2<span class=\"token variable\">)</span></span>\n  <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"The password for <span class=\"token variable\">$dmg</span> is <span class=\"token variable\">$password</span>\"</span>\n  <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"Setting empty password\"</span>\n  <span class=\"token builtin class-name\">printf</span> <span class=\"token string\">'%s<span class=\"token entity\" title=\"\\0\">\\0</span>'</span> <span class=\"token string\">\"<span class=\"token variable\">$password</span>\"</span> <span class=\"token string\">''</span> <span class=\"token operator\">|</span> hdiutil chpass <span class=\"token string\">\"<span class=\"token variable\">${dmg}</span>\"</span> -oldstdinpass -newstdinpass\n  <span class=\"token function\">rm</span> <span class=\"token string\">\"<span class=\"token variable\">${dmg}</span>\"</span>.hash\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","timeToRead":4,"excerpt":"John The Ripper is a free and open-source software for fast password cracking. Cracking DMG, RAR and other types of passwords is made easier…","fileAbsolutePath":"/home/runner/work/calvin.me/calvin.me/master/posts/2020-07-26-cracking-passwords-on-macos/index.md","frontmatter":{"title":"Cracking .DMG, .RAR and other passwords on MacOS","categories":["Security","Programming","Hacking"],"tags":["john the ripper","password","cracking","macos"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"fixed","backgroundColor":"#080808","images":{"fallback":{"src":"/static/07f666863886d4280fce16f2bc83d3a2/ccc8a/thumbnail.png","srcSet":"/static/07f666863886d4280fce16f2bc83d3a2/ccc8a/thumbnail.png 150w,\n/static/07f666863886d4280fce16f2bc83d3a2/67d4a/thumbnail.png 300w","sizes":"150px"},"sources":[{"srcSet":"/static/07f666863886d4280fce16f2bc83d3a2/3554d/thumbnail.webp 150w,\n/static/07f666863886d4280fce16f2bc83d3a2/c437f/thumbnail.webp 300w","type":"image/webp","sizes":"150px"}]},"width":150,"height":150}}}}}},"pageContext":{"filter":"/^.*\\/\\d{4}-\\d{2}-\\d{2}-cracking-passwords-on-macos\\/.*$/"}},"staticQueryHashes":[]}